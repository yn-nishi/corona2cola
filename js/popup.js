"use strict";
// Copyright 2021 yn-nishi All Rights Reserved.
var _a;
// 設定内容表示(メイン処理)
chrome.storage.local.get(null, function (storage) {
    loadSettings(storage);
    var $inputArea = document.getElementById('input-area');
    Object.keys(storage.kw).forEach(function (k, i) {
        if (k !== 'extensionFunction') {
            addInput($inputArea, i, k, storage.kw[k]);
        }
    });
    addInput($inputArea, Object.keys(storage.kw).length);
    document.addEventListener("change", function (e) {
        var _a;
        var numberOfInputs = document.querySelectorAll('#input-area input').length / 2;
        console.log('全部で', numberOfInputs, '行あるよ');
        var selectedId = (_a = e.target) === null || _a === void 0 ? void 0 : _a.getAttribute('id');
        if (selectedId === 'k-' + (numberOfInputs - 1)) {
            addInput($inputArea, numberOfInputs);
        }
    });
});
// 設定初期化
var loadSettings = function (storage) {
    console.log('読み込み一発目の現在の設定');
    console.log(storage);
    if (Object.keys(storage.kw).length < 2) {
        chrome.storage.local.set(initialSettings);
        console.log(initialSettings, '初期設定が設定されました');
        console.log(storage);
    }
    var $switch = document.getElementById('customSwitch1');
    $switch === null || $switch === void 0 ? void 0 : $switch.addEventListener('change', function () {
        storage.affect = $switch.checked;
        chrome.storage.local.set({ 'affect': storage.affect });
        console.log('affectの設定が', storage.affect, 'に変更されました');
        console.log(storage);
    });
};
// 設定更新
(_a = document.getElementById('save')) === null || _a === void 0 ? void 0 : _a.addEventListener('click', function () {
    chrome.storage.local.set({ kw: {} });
    var newKw = {};
    var numberOfInputs = document.getElementsByTagName('input').length / 2;
    for (var i = 0; i < numberOfInputs - 1; i++) {
        var newK = document.getElementById('k-' + i);
        var newKey = newK.value.trim();
        var newV = document.getElementById('v-' + i);
        var newVal = newV.value;
        if (newKey.length > 0) {
            newKw[newKey] = newVal;
        }
    }
    chrome.storage.local.set({ kw: newKw });
    notice('設定が保存されました。');
    // chrome.storage.local.get(null, (storage)=>{
    //   console.log('設定完了')
    //   console.log(storage)
    // })
    // location.reload()
});
//<input> 作成 & 追加
var addInput = function (parent, num, key, val) {
    if (key === void 0) { key = ''; }
    if (val === void 0) { val = ''; }
    var $div = document.createElement('div');
    $div.className = 'input-pair';
    parent.appendChild($div);
    var $newInputKey = document.createElement('input');
    $newInputKey.type = 'search';
    $newInputKey.id = 'k-' + num;
    $newInputKey.className = 'input';
    $newInputKey.setAttribute('value', key);
    $div.appendChild($newInputKey);
    var $arrow = document.createElement('div');
    $arrow.className = 'arrow';
    $div.appendChild($arrow);
    var $newInputVal = document.createElement('input');
    $newInputVal.type = 'search';
    $newInputVal.id = 'v-' + num;
    $newInputVal.className = 'input';
    $newInputVal.setAttribute('value', val);
    $div.appendChild($newInputVal);
};
var initialSettings = {
    affect: true,
    kw: {
        'コロナ': 'コーラ',
        'マスク': 'フリスク'
    }
};
var notice = function (message) {
    var $notice = document.getElementById('notice');
    $notice.textContent = message;
};
// chrome.storage.local.clear()
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicG9wdXAuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi90cy9wb3B1cC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUEsK0NBQStDOztBQUUvQyxnQkFBZ0I7QUFDaEIsTUFBTSxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLElBQUksRUFBRSxVQUFDLE9BQU87SUFDckMsWUFBWSxDQUFDLE9BQU8sQ0FBQyxDQUFBO0lBQ3JCLElBQU0sVUFBVSxHQUFHLFFBQVEsQ0FBQyxjQUFjLENBQUMsWUFBWSxDQUFnQixDQUFBO0lBQ3ZFLE1BQU0sQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLEVBQUUsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxVQUFDLENBQUMsRUFBRSxDQUFDO1FBQ25DLElBQUcsQ0FBQyxLQUFLLG1CQUFtQixFQUFFO1lBQzVCLFFBQVEsQ0FBQyxVQUFVLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxPQUFPLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUE7U0FDMUM7SUFDSCxDQUFDLENBQUMsQ0FBQTtJQUNGLFFBQVEsQ0FBQyxVQUFVLEVBQUUsTUFBTSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsRUFBRSxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUE7SUFDcEQsUUFBUSxDQUFDLGdCQUFnQixDQUFDLFFBQVEsRUFBRSxVQUFDLENBQUM7O1FBQ2xDLElBQU0sY0FBYyxHQUFXLFFBQVEsQ0FBQyxnQkFBZ0IsQ0FBQyxtQkFBbUIsQ0FBQyxDQUFDLE1BQU0sR0FBRyxDQUFDLENBQUE7UUFDeEYsT0FBTyxDQUFDLEdBQUcsQ0FBQyxLQUFLLEVBQUMsY0FBYyxFQUFDLE1BQU0sQ0FBQyxDQUFBO1FBQ3hDLElBQU0sVUFBVSxTQUFzQixDQUFDLENBQUMsTUFBTywwQ0FBRSxZQUFZLENBQUMsSUFBSSxDQUFDLENBQUE7UUFDbkUsSUFBRyxVQUFVLEtBQUssSUFBSSxHQUFFLENBQUMsY0FBYyxHQUFHLENBQUMs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